{"version":3,"sources":["types/index.ts","logic/index.ts","selectors/index.ts","state/reducer.ts","state/index.ts","components/CellText.tsx","components/Cell.tsx","components/GridCellContainer.tsx","components/Grid.tsx","components/Confetti.tsx","components/GameOverDialog.tsx","components/OutOfFlagsDialog.tsx","components/Configuration.tsx","components/Minesweeper.tsx","App.tsx","index.tsx"],"names":["CellStatus","GameStatus","coordinateToIndex","height","x","y","getAdjacentIndexes","index","width","Math","floor","adjacentIndexes","i","max","min","j","push","initBoard","mineCount","isSuperman","board","Array","mineIndexes","Set","size","rand","random","add","status","Visible","Hidden","isMine","has","adjacentMinesCount","filter","length","getFlaggedCells","state","cell","Flagged","revealCell","newBoard","Revealed","Lost","currAdjacentIndexes","currIndex","revealClearAdjacentCells","nonRevealedCells","Won","InProgress","minesweeperReducer","action","type","payload","flaggedCells","showOutOfFlags","remainingFlags","find","flagCell","map","emptyContext","dispatch","MinesweeperContext","React","createContext","origMinesweeperReducer","CellText","className","adjacentMinesCountName","n","Cell","coordinate","useContext","getCellByCoordinate","toLowerCase","onClick","e","shiftKey","memo","props","style","rowIndex","columnIndex","areEqual","Grid","forwardRef","ref","containerHeight","containerWidth","columnCount","columnWidth","rowCount","rowHeight","GridCellContainer","Confetti","data-testid","GameOverDialog","onClose","Dialog","open","aria-labelledby","aria-describedby","DialogTitle","id","messageByStatus","DialogActions","Button","color","autoFocus","useStyles","makeStyles","theme","createStyles","configuration","padding","spacing","sliders","display","inputContainer","flex","buttons","textAlign","margin","newGame","useState","setWidth","setHeight","setMineCount","classes","Typography","gutterBottom","Slider","value","valueLabelDisplay","onChange","event","newValue","variant","FormControlLabel","control","Switch","checked","name","label","Minesweeper","flagsLeft","useRef","current","scrollTo","scrollLeft","scrollTop","OutOfFlagsDialog","initialState","App","persistedState","useReducer","localforage","setItem","Provider","a","getItem","ReactDOM","render","StrictMode","document","getElementById","init"],"mappings":"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","file":"static/js/main.6f622895.chunk.js","sourcesContent":["export enum CellStatus {\n  Hidden,\n  Revealed,\n  Flagged,\n  Visible,\n}\n\nexport enum GameStatus {\n  InProgress,\n  Won,\n  Lost,\n}\n\nexport type Cell = {\n  status: CellStatus;\n  isMine: boolean;\n  adjacentMinesCount: number;\n};\n\nexport type Coordinate = {\n  x: number;\n  y: number;\n};\n\nexport type Board = Array<Cell>;\n\nexport type State = {\n  status: GameStatus;\n  board: Board;\n  width: number;\n  height: number;\n  mineCount: number;\n  showOutOfFlags?: boolean;\n  isSuperman?: boolean;\n};\n\nexport type Action =\n  | { type: \"CELL_REVEAL\"; payload: Coordinate }\n  | { type: \"CELL_FLAG\"; payload: Coordinate }\n  | { type: \"NEW_GAME\"; payload: State }\n  | { type: \"HIDE_OUT_OF_FLAGS\" }\n  | { type: \"TOGGLE_SUPERMAN\"; payload: boolean };\n\nexport type Context = {\n  state: State;\n  dispatch: React.Dispatch<Action>;\n};\n","import { Board, Coordinate, CellStatus } from \"../types\";\n\nexport const coordinateToIndex = ({ x, y }: Coordinate, height: number) =>\n  x * height + y;\n\nconst getAdjacentIndexes = (index: number, width: number, height: number) => {\n  const x = Math.floor(index / height);\n  const y = index % height;\n  const adjacentIndexes: Array<number> = [];\n\n  for (let i = Math.max(x - 1, 0); i <= Math.min(x + 1, width - 1); i++) {\n    for (let j = Math.max(y - 1, 0); j <= Math.min(y + 1, height - 1); j++) {\n      if (i === x && j === y) {\n        continue;\n      }\n\n      adjacentIndexes.push(coordinateToIndex({ x: i, y: j }, height));\n    }\n  }\n\n  return adjacentIndexes;\n};\n\nexport const initBoard = (\n  width: number,\n  height: number,\n  mineCount: number,\n  isSuperman?: boolean\n) => {\n  const board: Board = new Array(width * height);\n  const mineIndexes = new Set<number>();\n\n  while (mineIndexes.size < mineCount) {\n    const rand = Math.floor(Math.random() * width * height);\n    mineIndexes.add(rand);\n  }\n\n  for (let i = 0; i < width * height; i++) {\n    board[i] = {\n      status: isSuperman ? CellStatus.Visible : CellStatus.Hidden,\n      isMine: mineIndexes.has(i),\n      adjacentMinesCount: getAdjacentIndexes(i, width, height).filter((index) =>\n        mineIndexes.has(index)\n      ).length,\n    };\n  }\n\n  return board;\n};\n\nexport const revealClearAdjacentCells = (\n  board: Board,\n  index: number,\n  width: number,\n  height: number\n) => {\n  const newBoard = [...board];\n  const adjacentIndexes = new Set(\n    getAdjacentIndexes(index, width, height).filter(\n      (index) => board[index].status !== CellStatus.Revealed\n    )\n  );\n\n  for (const index of adjacentIndexes) {\n    const cell = newBoard[index];\n\n    if (\n      cell.status === CellStatus.Hidden ||\n      cell.status === CellStatus.Visible\n    ) {\n      newBoard[index] = {\n        ...cell,\n        status: CellStatus.Revealed,\n      };\n\n      if (!cell.adjacentMinesCount) {\n        const currAdjacentIndexes = getAdjacentIndexes(index, width, height);\n\n        for (const currIndex of currAdjacentIndexes) {\n          adjacentIndexes.add(currIndex);\n        }\n      }\n    }\n  }\n\n  return newBoard;\n};\n","import { State, Coordinate, Cell, CellStatus } from \"../types\";\nimport { coordinateToIndex } from \"../logic\";\n\nexport const getCellByCoordinate = (\n  state: State,\n  coordinate: Coordinate\n): Cell => {\n  return state.board[coordinateToIndex(coordinate, state.height)];\n};\n\nexport const getFlaggedCells = (state: State): Cell[] => {\n  return state.board.filter((cell) => cell.status === CellStatus.Flagged);\n};\n","import { State, Action, GameStatus, Cell, CellStatus, Board } from \"../types\";\nimport { revealClearAdjacentCells, coordinateToIndex } from \"../logic\";\nimport { getFlaggedCells } from \"../selectors\";\n\nconst revealCell = ({\n  board,\n  index,\n  width,\n  height,\n  mineCount,\n}: {\n  board: Board;\n  index: number;\n  width: number;\n  height: number;\n  mineCount: number;\n}): [Board, GameStatus] => {\n  let newBoard = [...board];\n  newBoard[index] = {\n    ...newBoard[index],\n    status: CellStatus.Revealed,\n  };\n\n  if (newBoard[index].isMine) {\n    return [newBoard, GameStatus.Lost];\n  }\n\n  if (!newBoard[index].adjacentMinesCount) {\n    newBoard = revealClearAdjacentCells(newBoard, index, width, height);\n  }\n\n  const nonRevealedCells = newBoard.filter(\n    (cell) => cell.status !== CellStatus.Revealed\n  );\n\n  return [\n    newBoard,\n    nonRevealedCells.length === mineCount\n      ? GameStatus.Won\n      : GameStatus.InProgress,\n  ];\n};\n\nconst flagCell = ({\n  board,\n  index,\n  flaggedCells,\n  mineCount,\n  isSuperman,\n}: {\n  board: Board;\n  index: number;\n  flaggedCells: Cell[];\n  mineCount: number;\n  isSuperman?: boolean;\n}): [Board, GameStatus] => {\n  const remainingFlags = mineCount - flaggedCells.length;\n  const newBoard = [...board];\n  newBoard[index] = {\n    ...newBoard[index],\n    status:\n      newBoard[index].status === CellStatus.Flagged\n        ? isSuperman\n          ? CellStatus.Visible\n          : CellStatus.Hidden\n        : CellStatus.Flagged,\n  };\n\n  if (\n    newBoard[index].isMine &&\n    remainingFlags === 1 &&\n    newBoard[index].status === CellStatus.Flagged &&\n    !flaggedCells.find((cell) => !cell.isMine)\n  ) {\n    return [newBoard, GameStatus.Won];\n  }\n\n  return [newBoard, GameStatus.InProgress];\n};\n\nconst minesweeperReducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"CELL_REVEAL\": {\n      if (state.status !== GameStatus.InProgress) {\n        return state;\n      }\n\n      const index = coordinateToIndex(action.payload, state.height);\n\n      if (\n        state.board[index].status !== CellStatus.Hidden &&\n        state.board[index].status !== CellStatus.Visible\n      ) {\n        return state;\n      }\n\n      const [board, status] = revealCell({\n        ...state,\n        index,\n      });\n\n      return { ...state, board, status };\n    }\n\n    case \"CELL_FLAG\": {\n      if (state.status !== GameStatus.InProgress) {\n        return state;\n      }\n\n      const index = coordinateToIndex(action.payload, state.height);\n\n      if (state.board[index].status === CellStatus.Revealed) {\n        return state;\n      }\n\n      const flaggedCells = getFlaggedCells(state);\n      const remainingFlags = state.mineCount - flaggedCells.length;\n\n      if (!remainingFlags && state.board[index].status !== CellStatus.Flagged) {\n        return { ...state, showOutOfFlags: true };\n      }\n\n      const [board, status] = flagCell({\n        ...state,\n        index,\n        flaggedCells,\n      });\n\n      return { ...state, board, status };\n    }\n\n    case \"NEW_GAME\": {\n      return action.payload;\n    }\n\n    case \"HIDE_OUT_OF_FLAGS\": {\n      return { ...state, showOutOfFlags: false };\n    }\n\n    case \"TOGGLE_SUPERMAN\": {\n      return {\n        ...state,\n        board: state.board.map((cell) => {\n          if (action.payload) {\n            return cell.status === CellStatus.Hidden\n              ? { ...cell, status: CellStatus.Visible }\n              : cell;\n          } else {\n            return cell.status === CellStatus.Visible\n              ? { ...cell, status: CellStatus.Hidden }\n              : cell;\n          }\n        }),\n        isSuperman: action.payload,\n      };\n    }\n\n    default: {\n      return state;\n    }\n  }\n};\n\nexport default minesweeperReducer;\n","import React from \"react\";\nimport { Context, GameStatus } from \"../types\";\nimport origMinesweeperReducer from \"./reducer\";\n\nexport const emptyContext: Context = {\n  state: {\n    status: GameStatus.InProgress,\n    board: [],\n    width: 1,\n    height: 2,\n    mineCount: 3,\n  },\n  dispatch: () => {},\n};\nexport const MinesweeperContext = React.createContext<Context>(emptyContext);\nexport const minesweeperReducer = origMinesweeperReducer;\n","import React from \"react\";\nimport { Cell, CellStatus } from \"../types\";\nimport \"./CellText.css\";\n\nconst CellText = ({ cell }: { cell: Cell }) => {\n  if (\n    cell.status === CellStatus.Revealed ||\n    cell.status === CellStatus.Visible\n  ) {\n    if (cell.isMine) {\n      return <i className=\"material-icons bomb\">new_releases</i>;\n    }\n\n    return <span>{cell.adjacentMinesCount || \"\"}</span>;\n  }\n\n  if (cell.status === CellStatus.Flagged) {\n    return <i className=\"material-icons flag\">tour</i>;\n  }\n\n  return <span></span>;\n};\n\nexport default CellText;\n","import React, { useContext } from \"react\";\nimport { Coordinate, CellStatus } from \"../types\";\nimport { MinesweeperContext } from \"../state\";\nimport { getCellByCoordinate } from \"../selectors\";\nimport CellText from \"./CellText\";\n\nconst adjacentMinesCountName = (n: number) => {\n  switch (n) {\n    case 1:\n      return \"one\";\n    case 2:\n      return \"two\";\n    case 3:\n      return \"three\";\n    case 4:\n      return \"four\";\n    case 5:\n      return \"five\";\n    case 6:\n      return \"six\";\n    case 7:\n      return \"seven\";\n    case 8:\n      return \"eight\";\n    default:\n      return \"\";\n  }\n};\n\nconst Cell = (coordinate: Coordinate) => {\n  const { state, dispatch } = useContext(MinesweeperContext);\n  const cell = getCellByCoordinate(state, coordinate);\n  const onClick = (e: React.MouseEvent) => {\n    if (!e.shiftKey) {\n      dispatch({ type: \"CELL_REVEAL\", payload: coordinate });\n    } else {\n      dispatch({ type: \"CELL_FLAG\", payload: coordinate });\n    }\n  };\n\n  return (\n    <div\n      className={`cell-content ${CellStatus[\n        cell.status\n      ].toLowerCase()} ${adjacentMinesCountName(cell.adjacentMinesCount)}`}\n      onClick={onClick}\n    >\n      <CellText cell={cell} />\n    </div>\n  );\n};\n\nexport default Cell;\n","import React from \"react\";\nimport { GridChildComponentProps, areEqual } from \"react-window\";\nimport Cell from \"./Cell\";\nimport \"./GridCellContainer.css\";\n\nconst GridCellContainer = (props: GridChildComponentProps) => (\n  <div style={props.style}>\n    <div className=\"cell\">\n      <Cell y={props.rowIndex} x={props.columnIndex} />\n    </div>\n  </div>\n);\n\nexport default React.memo(GridCellContainer, areEqual);\n","import React, { useContext } from \"react\";\nimport AutoSizer from \"react-virtualized-auto-sizer\";\nimport { FixedSizeGrid } from \"react-window\";\nimport { MinesweeperContext } from \"../state\";\nimport GridCellContainer from \"./GridCellContainer\";\n\nconst Grid = React.forwardRef<FixedSizeGrid>((props, ref) => {\n  const { state } = useContext(MinesweeperContext);\n\n  return (\n    <AutoSizer>\n      {({ height: containerHeight, width: containerWidth }) => {\n        return (\n          <FixedSizeGrid\n            className=\"minesweeper-grid\"\n            columnCount={state.width}\n            columnWidth={50}\n            height={containerHeight}\n            rowCount={state.height}\n            rowHeight={50}\n            width={containerWidth}\n            ref={ref}\n          >\n            {GridCellContainer}\n          </FixedSizeGrid>\n        );\n      }}\n    </AutoSizer>\n  );\n});\n\nexport default Grid;\n","import React from \"react\";\nimport \"./Confetti.css\";\n\nconst Confetti = () => {\n  return (\n    <div data-testid=\"confetti\">\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n      <div className=\"confetti\" />\n    </div>\n  );\n};\n\nexport default Confetti;\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport { GameStatus } from \"../types\";\n\nconst messageByStatus = (status: GameStatus) => {\n  switch (status) {\n    case GameStatus.Won: {\n      return \"You win!\";\n    }\n    case GameStatus.Lost: {\n      return \"You lose :(\";\n    }\n    case GameStatus.InProgress: {\n      return \"Restarting...\";\n    }\n  }\n};\n\nconst GameOverDialog = ({\n  status,\n  onClose,\n}: {\n  status: GameStatus;\n  onClose: () => void;\n}) => {\n  return (\n    <Dialog\n      open={status !== GameStatus.InProgress}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">\n        {messageByStatus(status)}\n      </DialogTitle>\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\" autoFocus>\n          Play again\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default GameOverDialog;\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n\nconst GameOverDialog = ({\n  open,\n  onClose,\n}: {\n  open: boolean;\n  onClose: () => void;\n}) => {\n  return (\n    <Dialog\n      open={open}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">No more flags left.</DialogTitle>\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\" autoFocus>\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default GameOverDialog;\n","import React, { useState, useContext } from \"react\";\nimport Slider from \"@material-ui/core/Slider\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Button from \"@material-ui/core/Button\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport Switch from \"@material-ui/core/Switch\";\nimport { MinesweeperContext } from \"../state\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    configuration: {\n      padding: theme.spacing(1),\n    },\n    sliders: {\n      display: \"flex\",\n    },\n    inputContainer: {\n      padding: \"10px\",\n      flex: 1,\n    },\n    buttons: {\n      textAlign: \"left\",\n      \"& > *\": {\n        margin: theme.spacing(1),\n      },\n    },\n  })\n);\n\nconst Configuration = ({\n  newGame,\n}: {\n  newGame: (width: number, height: number, mineCount: number) => void;\n}) => {\n  const { state, dispatch } = useContext(MinesweeperContext);\n  const [width, setWidth] = useState<number>(state.width);\n  const [height, setHeight] = useState<number>(state.height);\n  const [mineCount, setMineCount] = useState<number>(state.mineCount);\n  const classes = useStyles();\n\n  const handleWidthChange = (\n    event: React.ChangeEvent<{}>,\n    newValue: number | number[]\n  ) => {\n    setWidth(newValue as number);\n  };\n\n  const handleHeightChange = (\n    event: React.ChangeEvent<{}>,\n    newValue: number | number[]\n  ) => {\n    setHeight(newValue as number);\n  };\n\n  const handleMineCountChange = (\n    event: React.ChangeEvent<{}>,\n    newValue: number | number[]\n  ) => {\n    setMineCount(newValue as number);\n  };\n\n  return (\n    <div className={classes.configuration}>\n      <div className={classes.sliders}>\n        <div className={classes.inputContainer}>\n          <Typography gutterBottom>Width</Typography>\n          <Slider\n            value={width}\n            min={3}\n            max={300}\n            valueLabelDisplay=\"auto\"\n            onChange={handleWidthChange}\n            aria-labelledby=\"continuous-slider\"\n          />\n        </div>\n        <div className={classes.inputContainer}>\n          <Typography gutterBottom>Height</Typography>\n          <Slider\n            value={height}\n            min={3}\n            max={300}\n            valueLabelDisplay=\"auto\"\n            onChange={handleHeightChange}\n            aria-labelledby=\"continuous-slider\"\n          />\n        </div>\n        <div className={classes.inputContainer}>\n          <Typography gutterBottom>Mines</Typography>\n          <Slider\n            value={mineCount}\n            min={1}\n            max={width * height}\n            valueLabelDisplay=\"auto\"\n            onChange={handleMineCountChange}\n            aria-labelledby=\"continuous-slider\"\n          />\n        </div>\n      </div>\n      <div className={classes.buttons}>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={() =>\n            newGame(width, height, Math.min(mineCount, width * height))\n          }\n        >\n          New Game\n        </Button>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={state.isSuperman}\n              onChange={() =>\n                dispatch({\n                  type: \"TOGGLE_SUPERMAN\",\n                  payload: !state.isSuperman,\n                })\n              }\n              name=\"superman\"\n            />\n          }\n          label=\"Superman\"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(Configuration);\n","import React, { useContext, useRef } from \"react\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { FixedSizeGrid } from \"react-window\";\nimport Grid from \"./Grid\";\nimport Confetti from \"./Confetti\";\nimport GameOverDialog from \"./GameOverDialog\";\nimport OutOfFlagsDialog from \"./OutOfFlagsDialog\";\nimport Configuration from \"./Configuration\";\nimport { getFlaggedCells } from \"../selectors\";\nimport { MinesweeperContext } from \"../state\";\nimport { GameStatus } from \"../types\";\nimport { initBoard } from \"../logic\";\nimport \"./Minesweeper.css\";\n\nconst Minesweeper = () => {\n  const { state, dispatch } = useContext(MinesweeperContext);\n  const flagsLeft = state.mineCount - getFlaggedCells(state).length;\n  const ref = useRef<FixedSizeGrid>(null);\n\n  return (\n    <div className=\"minesweeper-container\">\n      {state.status === GameStatus.Won && <Confetti />}\n      <Configuration\n        newGame={(width, height, mineCount) => {\n          dispatch({\n            type: \"NEW_GAME\",\n            payload: {\n              status: GameStatus.InProgress,\n              width,\n              height,\n              mineCount,\n              board: initBoard(width, height, mineCount, state.isSuperman),\n              isSuperman: state.isSuperman,\n            },\n          });\n          ref.current?.scrollTo({ scrollLeft: 0, scrollTop: 0 });\n        }}\n      />\n      <OutOfFlagsDialog\n        open={!!state.showOutOfFlags}\n        onClose={() => dispatch({ type: \"HIDE_OUT_OF_FLAGS\" })}\n      />\n      <GameOverDialog\n        status={state.status}\n        onClose={() => {\n          dispatch({\n            type: \"NEW_GAME\",\n            payload: {\n              ...state,\n              status: GameStatus.InProgress,\n              board: initBoard(\n                state.width,\n                state.height,\n                state.mineCount,\n                state.isSuperman\n              ),\n            },\n          });\n          ref.current?.scrollTo({ scrollLeft: 0, scrollTop: 0 });\n        }}\n      />\n      <Typography gutterBottom>Flags left: {flagsLeft}</Typography>\n      <div className=\"grid-container\">\n        <Grid ref={ref} />\n      </div>\n    </div>\n  );\n};\n\nexport default Minesweeper;\n","import React, { useReducer } from \"react\";\nimport localforage from \"localforage\";\nimport { MinesweeperContext, minesweeperReducer } from \"./state\";\nimport { initBoard } from \"./logic\";\nimport Minesweeper from \"./components/Minesweeper\";\nimport { GameStatus, State } from \"./types\";\n\nconst width = 10;\nconst height = 10;\nconst mineCount = 10;\n\nconst initialState = {\n  status: GameStatus.InProgress,\n  board: initBoard(width, height, mineCount),\n  width,\n  height,\n  mineCount,\n};\n\nfunction App({ persistedState }: { persistedState: State }) {\n  const [state, dispatch] = useReducer(\n    minesweeperReducer,\n    persistedState || initialState\n  );\n  localforage.setItem(\"state\", state);\n\n  return (\n    <MinesweeperContext.Provider value={{ state, dispatch }}>\n      <Minesweeper />\n    </MinesweeperContext.Provider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport localforage from \"localforage\";\nimport { State } from \"./types\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nconst init = async () => {\n  const persistedState: State = await localforage.getItem(\"state\");\n\n  ReactDOM.render(\n    <React.StrictMode>\n      <App persistedState={persistedState} />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n};\n\ninit();\n"],"sourceRoot":""}